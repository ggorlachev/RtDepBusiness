.. _dosimetry_equipment:

Дозиметрическое оборудование
============================

Установка и настройка
---------------------

IBA myQA
~~~~~~~~

Полная установка включает ряд стандартных около системных продуктов.
Из существенного:

- MS SQL Server 2016  (полная установка)
- MATLAB Runtime 9.0.

Основная версия отделения устанавливается на компьютере **w66-ecl-08**.



IBA дозиметрия
--------------


Матрица (MatriXX)
------------------

Матрица необходима для того, чтобы проверить рассчитанный в ПО Eclipse дозовый план пациента.

Для этого на откалиброванной матрице проводятся измерения дозы на специальном фантоме при аналогичных условиях с целью
получить максимальное отклонение от плана не более 2%.

*Калибровка матрицы:*

Калибровка матрицы заключается в том, чтобы получить для каждой энергии (если необходимо также и для каждой мощности облучения)
калибровочный коэффициент - значение, которое переводит так называемые отсчеты, измеряемые матрицей, в Греи. 

.. sidebar:: Калибровочный коэффициент

    Например, матрица
    измеряет 100 отсчетов, и мы знаем, что доза, полученная матрицей, должна составлять 10 Гр, тогда выходной коэффициент равен 10 Гр/100 отсч. = 0,1 Гр/отсч.

Значения дозы полученные при прохождении пучка (размер поля 10x10см) через водный фантом (SDD = 100 см, SSD = 90 см) являются
референсными при проведении калибровки на матрице. Для воссоздания аналогичных условий лазеры выставляются на перекрестии на
горизонтальной поверхности матрицы. Затем на матрицу нужно осторожно поместить 9.4 см твердой воды. Значение 9.4 выбрано из
следующих соображений:

.. figure:: images/matrixx_CT.png
    :name: _matrixx_CT
    :align: center
    :width: 100%
    :figclass: align-center

    Рисунок 7.3.1 - КТ-скан MatriXX

Расстояние от поверхности твердой воды до центра ионизационных камер матрицы должно быть равно 10 см. Было проведено КТ-сканирование
матрицы (рис. 7.3.1), откуда видно, что расстояние от поверхности матрицы до центра камеры - 6 мм, следовательно, высота пластин
из твердой воды, которую необходимо поместить сверху - 9.4 см.

Для начала калибровки после правильного размещения матрицы и пластин из твердой воды необходимо подключить питание к матрице при
помощи специального провода идущего в комплекте и включить ее кнопкой на задней панели. Далее при помощи кабеля Ethernet необходимо
подключить матрицу к ПК с установленным на нем ПО MyQA. На рабочем столе ПК находим приложение MyQA и кликаем по ярлыку дважды - 
открывается окно для авторизации: вводим имя пользователя и пароль. В верхнем левом углу, если выбрано MyQA Patients кликаем и
выбираем MyQA Platform (рис. 7.3.2).

.. figure:: images/myqa1.png
    :name: _myqa1
    :align: center
    :scale: 80%
    :figclass: align-center

    Рисунок 7.3.2 - Действия при входе в MyQA

Далее переходим во вкладку *Equipment setup* и в списке устройств выбираем *MatriXX* (рис. 7.3.3). 

.. figure:: images/myqa2.png
    :name: _myqa2
    :align: center
    :scale: 50%
    :figclass: align-center

    Рисунок 7.3.3 - Начало работы с матрицей

В окне *Calibrations* нажимаем кнопку *Edit* и в открывшемся окне *Connect* - устройство запросит набор фона,
нажимаем *Compensate* и ожидаем:

.. figure:: images/myqa3.png
    :name: _myqa3
    :align: center
    :scale: 55%
    :figclass: align-center

    Рисунок 7.3.4 - Подготовка к калибровке матрицы

После набора фона можно приступать к калибровке. Для проведения калибровки по конкретной энергии для определенного
ускорителя нажимаем *New output calibration*.

.. figure:: images/myqa4.png
    :name: _myqa4
    :align: center
    :scale: 55%
    :figclass: align-center

    Рисунок 7.3.5 - Калибровка матрицы

В поле *1* выбираем ускоритель, на котором мы проводим калибровку
В поле *2* выбираем необходимую энергию.
В поле *3* вводим рефернсное значение дозы для данной энергии.
В полях *4* и *5* вводим актульные значения температуры и давления в бункере ускорителя.
Затем нажимаем на кнопку Measure (кнопка *6*) и пускаем пучок с ускорителя. Если измерение проведено неправильно, 
то можно сбросить его с помощью кнопки Reset (кнопка *7*).
После измерения в поле *8* описываем измерение в следующей форме: "Accelerator Energy".
При калибровке полей без сглаживающего фильтра (FFF) также необходимо указать мощность дозы в МЕ.
В поле *9* указываем отпущенную дозу (100 МЕ). Если необходимо в поле 10 можно оставить комментарии
к проведенному измерению.


Dynamic platform
----------------

Для начала работы с *Dynamic platform* необходимо установить софт 
с USB-носителя идущего в комплекте. Вставляем его в ПК, который планируется испльзовать для работы с платформой:

- Из папки USB-to-Network Adapter устанавливаем драйвера для использования переходника USB-Ethernet (В папке находим установщик *Setup.exe* и кликаем два раза);
- Из папки InstallTrioPCMotion_2_12_0 устанавливаем софт TrioPCMotion;
- Из папки MotionControl.Setup_V2.7.7 устанавливаем софт MotionControl (дважды кликаем по *setup.exe*).

Подключаем соответствующие кабеля аппарата к соответствующим гнездам, только потом подключаем питание.
Затем подключаем Ethernet кабель к платформе, а оставшийся конец к переходнику USB-Ethernet и вставляем его в используемый ПК 
в USB-порт. На компьютере открываем *Параметры* -> *Сеть и интернет* -> *Настройка параметров адаптера* и находим
там новое проводное подключение *ASIX ... Gigabit*, кликаем правой кнопкой мыши и заходим в *Свойства*. Находим протокол *IPv4*
и кликаем дважды. В открывшемся окне выбираем *Использовать следующий IP адрес* и вводим следующий IP адрес: 192.168.0.101.
При нажатии на поле "Маска подсети" автоматически должно заполниться 255.255.255.0. Нажимаем "ОК". Для проверки
подключения открываем командную строку (командную строку можно открыть так: Win+R и написать в открывшемся окне *cmd*
и нажать *Enter*) и прописываем там *ping 192.168.0.101*. Если статистика по этому IP адресу будет получена - все настроено
верно. На рабочем столе кликаем дважды по создавшемуся ярлыку *CIRS Motion Control* - можно задавать
траекторию движения и работать с устройством!